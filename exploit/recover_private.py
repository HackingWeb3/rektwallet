from ecdsa.curves import SECP256k1
from ecdsa.util import string_to_number
from hashlib import sha256

n = SECP256k1.order

def modinv(a, n):
    return pow(a, -1, n)

def recover_private_key(r, s1, s2, z1, z2):
    # k = (z1 - z2) / (s1 - s2) mod n
    k = ((z1 - z2) * modinv(s1 - s2, n)) % n
    # d = (s1 * k - z1) / r mod n
    d = ((s1 * k - z1) * modinv(r, n)) % n
    return d, k
