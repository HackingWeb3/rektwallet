# rektwallet
rektwallet is a deliberately vulnerable Bitcoin wallet written in Python. It demonstrates how poor nonce reuse in ECDSA signatures can lead to full private key compromise. Includes a lab environment, vulnerable implementation, and exploit scripts.




## setup 
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt


## generate dataset 

```
python3 generateBulkSignatures.py > dataSet.txt 
```

This generates the file dataSet.txt which is full of signed transactions. (used loosly since these are mock tranasctions we didn't keep a fake utxo set)


### To test the nonce for collision 
```python3 testNonce.py
[!!!] Duplicate r found at index 1048575: 97793243503830974537813184346131505324470061312903243101092203215109981519107
Total unique r values: 1048575
```

### to find collision in the dataset 
python3 analyzeDataset.py

this gives output such as:
```
[!] Duplicate r found: 97793243503830974537813184346131505324470061312903243101092203215109981519107
r1 = 97793243503830974537813184346131505324470061312903243101092203215109981519107, r2 = 97793243503830974537813184346131505324470061312903243101092203215109981519107
s1 = 65020667550384029878002899266613857920983154759235919890756052577341396676214, s2 = 33034189961794130796568847756260294775017496084204137608744782793957343441180
z1 = 74198174084568786506903746281705505916280004170902441879682295704675367070192, z2 = 91851151719039377105689158832382203300374019713334261368797345402775762827149
sig1 = d83503ab00361c52c184ccd19662dbd347f31d4a64f58572daf6d7580380bd038fc064c7ff328761524d66878fcfe3f28829c202a473d592ede8043037beee76
sig2 = d83503ab00361c52c184ccd19662dbd347f31d4a64f58572daf6d7580380bd034908b05de483b419f4123eedb475bef4eb8f09f746142efb9b7dd0852f67311
```



### Get keys and get paid 

```
python3 exploit_and_extract_keys.py 
ECDSA Private Key Recovery (Duplicate r)
Enter r: 97793243503830974537813184346131505324470061312903243101092203215109981519107
Enter s1: 65020667550384029878002899266613857920983154759235919890756052577341396676214 
Enter s2: 33034189961794130796568847756260294775017496084204137608744782793957343441180
Enter z1 (digest of message 1): 4198174084568786506903746281705505916280004170902441879682295704675367070192
Enter z2 (digest of message 2): 91851151719039377105689158832382203300374019713334261368797345402775762827149

Recovered Values:
Private key (decimal): 68159006461159195587683064963290532970068762570644922468209596322200059167680
Private key (hex): 0x96b0a16be79df271fb2c929dff15530e481c0c62d74684039efad7ec4958c3c0
Nonce k (decimal): 69745000128546432994099220903824819426548877077668262009505336768071019290057

```

